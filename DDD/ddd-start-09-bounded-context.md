# [DDD START!] 9장 도메인 모델과 BOUNDED CONTEXT

## 도메인 모델을 만들 때 유의사항

- 모델 하나로 도메인을 다 표현할 수 없다.
- 같은 용어라도 도메인 별로 의미가 다르다.
  - 카탈로그, 재고 관리, 주문, 배송 도메인의 상품의 의미가 다 다름
- 같은 논리적 존재도 도메인에 따라 용어가 다르다.
  - 사용자의 경우, 회원 도메인 - 회원 / 주문 도메인 - 주문자 / 배송 도메인 - 보내는 사람
- 이렇듯 용어가 다르므로, 도메인마다 모델을 만드는 게 낫다.
- 모델은 컨텍스트마다 의미가 다르고 이렇게 구분되는 경계를 BOUNDED CONTEXT라고 부른다.

## BOUNDED CONTEXT

![image](https://user-images.githubusercontent.com/22253556/132038162-7f0ef7b2-e1a3-422a-a3bd-4dfbac2bab00.png)

- 바운디드 컨텍스트는 조직 구조에 따라 결정되기도 한다.
- 모든 도메인을 하나의 바운디드 컨텍스트에서 구현할 수도 있다.
  - 이때, 하위 도메인의 모델이 섞이지 않도록 해야 한다.
  - 안 그러면 하위 도메인 별 기능 확장이 어렵게 돼서 서비스의 경쟁력이 떨어진다.

## BOUNDED CONTEXT 구현

- 바운디드 컨텍스트는 도메인 모델뿐만 아니라 사용자에게 제공하는 표현, 응용, 인프라 영역을 포함한다.
  - 그런데 반드시 도메인 주도 설계로 개발할 필요는 없고, 간단하게 CRUD 방식을 사용해도 된다.
  - 둘 다 혼합해서, CQRS 패턴을 적용해도 된다.

## BOUNDED CONTEXT 간 통합

- 기존 도메인에 새 기능을 추가할 때, 두 바운디드 컨텍스트 간 통합이 발생한다.

### 직접 통합

- 다른 도메인에서 사용할 기능을 기존 도메인 관점에서 인터페이스를 정의하고, 인프라 영역에서 이를 구현한다.
- 도메인 간 모델 변환도 수행해야 한다.

### 간접 통합

- 메시지 큐를 사용할 수 있다.
- 이때, 주고 받을 메시지의 데이터 구조를 일치시켜야 한다.

## BOUNDED CONTEXT 간 관계

### 고객/공급자 관계

- 가장 흔한 관계는 한쪽(상류)에서 API를 제공하고 다른 한쪽(하류)에서 그 API를 호출하는 관계이다.
  - API 변경 시, 두 컴포넌트 개발 팀 간 협력이 중요하다.

### 공개 호스트 서비스

- 상류 팀 하나에 여러 하류 팀이 존재하는 경우, 공개 호스트 서비스를 사용해 서비스의 일관성을 유지한다.

### 안티코럽션 계층

- 하류 컴포넌트는 안티코럽션 계층을 둬서 상류 서비스의 모델이 자신의 도메인 모델에 영향을 주지 않게 한다.

### 공유 커널

- 두 바운디드 컨텍스트가 같은 모델을 공유하는 경우, 해당 모델을 공유 커널이라 부른다.
  - 공유 커널은 중복을 줄여주지만, 두 팀이 모델을 공유하므로 모델을 변경하기 까다롭다.
  - 이로 인한 개발 일정 지연이 발생할 수 있다.

### 독립 방식

- 그냥 통합하지 않고 서로 독립적으로 모델을 발전시킨다.
- 모델의 규모가 커지면 별도의 통합 시스템을 만들어야 하는 경우가 생긴다.

## 컨텍스트 맵

- 전체 비즈니스를 조망할 수 있는 지도, 시스템의 전체 구조를 보여준다.
- 바운디드 컨텍스트 간의 관계를 표시한다.

![image](https://user-images.githubusercontent.com/22253556/132037906-87c4a382-6141-4a9b-bd5b-d5b8c575d73a.png)
